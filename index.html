<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVC Word Game</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Comic Sans MS', cursive, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 30px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            max-width: 700px;
            width: 100%;
        }

        h1 {
            text-align: center;
            color: #667eea;
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }

        .menu-screen, .game-screen {
            display: none;
        }

        .menu-screen.active, .game-screen.active {
            display: block;
        }

        .level-selector {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .level-btn {
            padding: 25px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s ease;
            text-align: center;
        }

        .level-btn:hover {
            transform: translateY(-5px);
        }

        .level-btn small {
            display: block;
            font-size: 0.7em;
            margin-top: 5px;
            opacity: 0.9;
        }

        .word-image {
            text-align: center;
            font-size: 5em;
            margin-bottom: 10px;
        }

        .target-boxes {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 50px;
            flex-wrap: wrap;
        }

        .target-box {
            width: 90px;
            height: 110px;
            border: 4px dashed #764ba2;
            border-radius: 15px;
            background: #f0f0ff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: #667eea;
            transition: all 0.3s ease;
        }

        .target-box.drag-over {
            background: #e0e0ff;
            border-color: #667eea;
            transform: scale(1.05);
        }

        .target-box.filled {
            background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);
            border-style: solid;
        }

        .letter-tiles {
            display: flex;
            justify-content: center;
            gap: 15px;
            flex-wrap: wrap;
            min-height: 120px;
        }

        .letter-tile {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5em;
            font-weight: bold;
            color: white;
            cursor: grab;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            user-select: none;
        }

        .letter-tile:active {
            cursor: grabbing;
        }

        .letter-tile:hover {
            transform: translateY(-5px);
        }

        .letter-tile.dragging {
            opacity: 0.5;
        }

        .letter-tile.hidden {
            opacity: 0;
            transform: scale(0);
            pointer-events: none;
        }

        .success-message {
            text-align: center;
            font-size: 1.8em;
            color: #4CAF50;
            margin-top: 30px;
            font-weight: bold;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .success-message.show {
            opacity: 1;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-10px); }
            75% { transform: translateX(10px); }
        }

        .progress {
            text-align: center;
            color: #764ba2;
            font-size: 1.2em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .btn {
            display: inline-block;
            margin: 10px;
            padding: 15px 40px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            transition: transform 0.2s ease;
        }

        .btn:hover {
            transform: translateY(-3px);
        }

        .btn-container {
            text-align: center;
            margin-top: 20px;
        }

        .instruction {
            text-align: center;
            color: #764ba2;
            font-size: 1.3em;
            margin-bottom: 20px;
            font-weight: bold;
        }

        .speak-btn {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 1.5em;
            cursor: pointer;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            margin: 0 auto 20px;
            display: block;
            transition: transform 0.2s ease;
        }

        .speak-btn:hover {
            transform: scale(1.1);
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="menu-screen active" id="menuScreen">
            <h1>üéØ Aamena's Word Spelling Game üéØ</h1>
            <div class="instruction">Aamena! Choose a word family to practice:</div>
            <div class="level-selector" id="levelSelector"></div>
        </div>

        <div class="game-screen" id="gameScreen">
            <h1 id="gameTitle">üéØ Spelling Game üéØ</h1>
            <div class="progress" id="progress"></div>
            <div class="word-image" id="wordImage">üìù</div>
            <button class="speak-btn" id="speakBtn" title="Hear the word">üîä</button>
            <div class="instruction" id="instruction"></div>
            
            <div class="target-boxes" id="targetBoxes"></div>
            <div class="letter-tiles" id="letterTiles"></div>

            <div class="success-message" id="successMessage">üéâ Great Job! üéâ</div>
            
            <div class="btn-container">
                <button class="btn" id="backBtn">‚Üê Back to Menu</button>
                <button class="btn" id="skipBtn">Skip Word ‚Üí</button>
            </div>
        </div>
    </div>

    <script>
        const wordDatabase = {
            'AT Family': [
                { word: 'AT', emoji: 'üìç' },
                { word: 'BAT', emoji: 'ü¶á' },
                { word: 'CAT', emoji: 'üê±' },
                { word: 'FAT', emoji: 'üéà' },
                { word: 'HAT', emoji: 'üé©' },
                { word: 'MAT', emoji: 'üßò' },
                { word: 'PAT', emoji: 'üëã' },
                { word: 'RAT', emoji: 'üêÄ' },
                { word: 'SAT', emoji: 'ü™ë' },
                { word: 'VAT', emoji: 'ü™£' },
                { word: 'TAT', emoji: '‚úèÔ∏è' }
            ],
            'AT Blends': [
                { word: 'BRAT', emoji: 'üò§' },
                { word: 'CHAT', emoji: 'üí¨' },
                { word: 'FLAT', emoji: 'üìè' },
                { word: 'GNAT', emoji: 'ü¶ü' },
                { word: 'PLAT', emoji: 'üó∫Ô∏è' },
                { word: 'PRAT', emoji: 'ü§™' },
                { word: 'SCAT', emoji: 'üèÉ' },
                { word: 'SLAT', emoji: 'ü™ü' },
                { word: 'SPAT', emoji: 'üí¢' },
                { word: 'STAT', emoji: 'üìä' },
                { word: 'THAT', emoji: 'üëà' }
            ],
            'Long AT Words': [
                { word: 'COMBAT', emoji: '‚öîÔ∏è' },
                { word: 'FORMAT', emoji: 'üìÑ' },
                { word: 'TOMCAT', emoji: 'üêà' },
                { word: 'BOBCAT', emoji: 'üêÜ' },
                { word: 'MUSKRAT', emoji: 'üêÄ' },
                { word: 'HABITAT', emoji: 'üè†' },
                { word: 'ACROBAT', emoji: 'ü§∏' }
            ],
            'AN Family': [
                { word: 'AN', emoji: 'üÖ∞Ô∏è' },
                { word: 'BAN', emoji: 'üö´' },
                { word: 'CAN', emoji: 'ü•´' },
                { word: 'DAN', emoji: 'üë®' },
                { word: 'FAN', emoji: 'ü™≠' },
                { word: 'MAN', emoji: 'üë®' },
                { word: 'PAN', emoji: 'üç≥' },
                { word: 'RAN', emoji: 'üèÉ' },
                { word: 'TAN', emoji: 'üü§' },
                { word: 'VAN', emoji: 'üöê' },
                { word: 'PLAN', emoji: 'üìã' },
                { word: 'SCAN', emoji: 'üì±' }
            ],
            'AM Family': [
                { word: 'AM', emoji: 'üåÖ' },
                { word: 'BAM', emoji: 'üí•' },
                { word: 'HAM', emoji: 'üçñ' },
                { word: 'JAM', emoji: 'üçì' },
                { word: 'PAM', emoji: 'üë©' },
                { word: 'RAM', emoji: 'üêè' },
                { word: 'SAM', emoji: 'üë®' },
                { word: 'YAM', emoji: 'üç†' },
                { word: 'SLAM', emoji: 'üö™' },
                { word: 'GRAM', emoji: '‚öñÔ∏è' }
            ],
            'AP Family': [
                { word: 'CAP', emoji: 'üß¢' },
                { word: 'GAP', emoji: '‚ÜîÔ∏è' },
                { word: 'LAP', emoji: 'üèÅ' },
                { word: 'MAP', emoji: 'üó∫Ô∏è' },
                { word: 'NAP', emoji: 'üò¥' },
                { word: 'RAP', emoji: 'üé§' },
                { word: 'SAP', emoji: 'üå≥' },
                { word: 'TAP', emoji: 'üö∞' },
                { word: 'ZAP', emoji: '‚ö°' },
                { word: 'CLAP', emoji: 'üëè' },
                { word: 'SNAP', emoji: 'üì∏' },
                { word: 'TRAP', emoji: 'ü™§' }
            ],
            'AG Family': [
                { word: 'BAG', emoji: 'üëú' },
                { word: 'GAG', emoji: 'ü§ê' },
                { word: 'HAG', emoji: 'üßô' },
                { word: 'LAG', emoji: 'üêå' },
                { word: 'NAG', emoji: 'üò†' },
                { word: 'RAG', emoji: 'üßπ' },
                { word: 'SAG', emoji: 'üìâ' },
                { word: 'TAG', emoji: 'üè∑Ô∏è' },
                { word: 'WAG', emoji: 'üêï' },
                { word: 'BRAG', emoji: 'üòé' },
                { word: 'FLAG', emoji: 'üö©' }
            ],
            'AD Family': [
                { word: 'BAD', emoji: 'üëé' },
                { word: 'DAD', emoji: 'üë®' },
                { word: 'HAD', emoji: '‚úÖ' },
                { word: 'LAD', emoji: 'üë¶' },
                { word: 'MAD', emoji: 'üò†' },
                { word: 'PAD', emoji: 'üìù' },
                { word: 'SAD', emoji: 'üò¢' }
            ]
        };

        let currentFamily = '';
        let currentWords = [];
        let currentWordIndex = 0;
        let currentWord = [];
        let letterTiles = [];

        const menuScreen = document.getElementById('menuScreen');
        const gameScreen = document.getElementById('gameScreen');
        const levelSelector = document.getElementById('levelSelector');
        const targetBoxes = document.getElementById('targetBoxes');
        const letterTilesContainer = document.getElementById('letterTiles');
        const successMessage = document.getElementById('successMessage');
        const instruction = document.getElementById('instruction');
        const wordImage = document.getElementById('wordImage');
        const progress = document.getElementById('progress');
        const speakBtn = document.getElementById('speakBtn');
        const backBtn = document.getElementById('backBtn');
        const skipBtn = document.getElementById('skipBtn');
        const gameTitle = document.getElementById('gameTitle');

        const audioContext = new (window.AudioContext || window.webkitAudioContext)();

        // Create level buttons
        Object.keys(wordDatabase).forEach(family => {
            const btn = document.createElement('button');
            btn.className = 'level-btn';
            btn.innerHTML = `${family}<small>${wordDatabase[family].length} words</small>`;
            btn.onclick = () => startGame(family);
            levelSelector.appendChild(btn);
        });

        function speakWord(word) {
            if ('speechSynthesis' in window) {
                speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(word);
                utterance.rate = 0.7;
                utterance.pitch = 1.2;
                utterance.volume = 1;
                
                const voices = speechSynthesis.getVoices();
                const preferredVoice = voices.find(voice => 
                    voice.name.includes('Female') || 
                    voice.name.includes('Google')
                );
                if (preferredVoice) {
                    utterance.voice = preferredVoice;
                }
                
                speechSynthesis.speak(utterance);
            }
        }

        function playSuccessSound() {
            const notes = [
                [523.25, 0.15], [659.25, 0.15], [783.99, 0.15], [1046.50, 0.3]
            ];
            
            notes.forEach((note, index) => {
                const [frequency, duration] = note;
                const oscillator = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                oscillator.frequency.setValueAtTime(frequency, audioContext.currentTime + index * 0.15);
                oscillator.type = 'triangle';
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime + index * 0.15);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + index * 0.15 + duration);
                
                oscillator.start(audioContext.currentTime + index * 0.15);
                oscillator.stop(audioContext.currentTime + index * 0.15 + duration);
            });
        }

        function shuffleArray(array) {
            const arr = [...array];
            for (let i = arr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [arr[i], arr[j]] = [arr[j], arr[i]];
            }
            return arr;
        }

        function startGame(family) {
            currentFamily = family;
            currentWords = [...wordDatabase[family]];
            currentWordIndex = 0;
            
            menuScreen.classList.remove('active');
            gameScreen.classList.add('active');
            gameTitle.textContent = `üéØ ${family} üéØ`;
            
            loadWord(0);
        }

        function loadWord(index) {
            if (index >= currentWords.length) {
                // Level complete
                successMessage.textContent = `üèÜ Amazing! You completed all ${currentWords.length} words in ${currentFamily}! üèÜ`;
                successMessage.classList.add('show');
                speakWord('Congratulations! You did it!');
                skipBtn.style.display = 'none';
                return;
            }

            const wordData = currentWords[index];
            const word = wordData.word;
            const letterCount = word.length;
            
            currentWord = new Array(letterCount).fill('');
            successMessage.classList.remove('show');
            skipBtn.style.display = 'inline-block';
            
            wordImage.textContent = wordData.emoji;
            instruction.textContent = `Spell: ${word}`;
            progress.textContent = `Word ${index + 1} of ${currentWords.length}`;
            
            // Create target boxes
            targetBoxes.innerHTML = '';
            for (let i = 0; i < letterCount; i++) {
                const box = document.createElement('div');
                box.className = 'target-box';
                box.dataset.position = i;
                setupBoxEvents(box);
                targetBoxes.appendChild(box);
            }
            
            // Create shuffled letter tiles
            const letters = word.split('');
            const shuffled = shuffleArray(letters);
            
            // Ensure not in correct order
            if (shuffled.join('') === word && letterCount > 2) {
                shuffled.reverse();
            }
            
            letterTilesContainer.innerHTML = '';
            shuffled.forEach((letter, idx) => {
                const tile = document.createElement('div');
                tile.className = 'letter-tile';
                tile.draggable = true;
                tile.dataset.letter = letter;
                tile.dataset.tileId = idx;
                tile.textContent = letter;
                
                tile.addEventListener('dragstart', handleDragStart);
                tile.addEventListener('dragend', handleDragEnd);
                
                letterTilesContainer.appendChild(tile);
            });
            
            letterTiles = document.querySelectorAll('.letter-tile');
            setTimeout(() => speakWord(word), 500);
        }

        function setupBoxEvents(box) {
            box.addEventListener('dragover', (e) => {
                e.preventDefault();
                box.classList.add('drag-over');
            });

            box.addEventListener('dragleave', () => {
                box.classList.remove('drag-over');
            });

            box.addEventListener('drop', (e) => {
                e.preventDefault();
                box.classList.remove('drag-over');
                
                if (box.textContent) return;
                
                const letter = e.dataTransfer.getData('text/plain');
                const tileId = parseInt(e.dataTransfer.getData('tileId'));
                const position = parseInt(box.dataset.position);
                
                box.textContent = letter;
                box.classList.add('filled');
                currentWord[position] = letter;
                
                letterTiles[tileId].classList.add('hidden');
                checkWord();
            });
        }

        function handleDragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.letter);
            e.dataTransfer.setData('tileId', e.target.dataset.tileId);
            e.target.classList.add('dragging');
        }

        function handleDragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function checkWord() {
            if (currentWord.every(letter => letter !== '')) {
                const correctWord = currentWords[currentWordIndex].word;
                
                if (currentWord.join('') === correctWord) {
                    setTimeout(() => {
                        successMessage.textContent = `üéâ Perfect! You spelled ${correctWord}! üéâ`;
                        successMessage.classList.add('show');
                        playSuccessSound();
                        
                        setTimeout(() => speakWord(correctWord), 500);
                        
                        setTimeout(() => {
                            currentWordIndex++;
                            loadWord(currentWordIndex);
                        }, 2500);
                    }, 300);
                } else {
                    setTimeout(() => {
                        document.querySelectorAll('.target-box').forEach(box => {
                            box.style.animation = 'shake 0.5s';
                        });
                        
                        setTimeout(() => resetBoxes(), 500);
                    }, 300);
                }
            }
        }

        function resetBoxes() {
            const letterCount = currentWords[currentWordIndex].word.length;
            currentWord = new Array(letterCount).fill('');
            
            document.querySelectorAll('.target-box').forEach(box => {
                box.textContent = '';
                box.classList.remove('filled');
                box.style.animation = '';
            });
            
            letterTiles.forEach(tile => tile.classList.remove('hidden'));
        }

        speakBtn.addEventListener('click', () => {
            if (currentWordIndex < currentWords.length) {
                speakWord(currentWords[currentWordIndex].word);
            }
        });

        backBtn.addEventListener('click', () => {
            gameScreen.classList.remove('active');
            menuScreen.classList.add('active');
            successMessage.classList.remove('show');
        });

        skipBtn.addEventListener('click', () => {
            currentWordIndex++;
            loadWord(currentWordIndex);
        });

        if ('speechSynthesis' in window) {
            speechSynthesis.getVoices();
        }
    </script>
</body>
</html>
